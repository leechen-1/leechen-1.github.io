<!DOCTYPE html><head> <meta http-equiv='Content-Type' content='text/html;charset=utf-8'><meta name='viewport' content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'><title></title><style>a {color: #607fa6;text-decoration:none;word-wrap:break-word;word-break:break-all;}.rich_media_title{padding-bottom:10px;margin-bottom:14px;border-bottom:1px solid #e7e7eb;}.rich_media_meta{display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:16px;}.rich_media_meta_text{color:#8c8c8c;}.rich_media_meta_list em {font-style: normal;}@media screen and (max-width:768px){.rich_media{position: relative;padding: 20px 15px 15px;background-color: #fff;}}.rich_media_content * {max-width: 100%!important;box-sizing: border-box!important;-webkit-box-sizing: border-box!important;word-wrap: break-word!important;}a.rich_media_meta_nickname{display: none;}@media screen and (min-width:1025px){.rich_media{position:relative;}a.rich_media_meta_nickname{display:inline-block!important;}span.rich_media_meta_nickname {display: none!important;}.rich_media {width:740px;margin-left:auto;margin-right:auto;}}a.fwjm{display: block;font-size: 12px;color: #ececec;}</style></head><body><div id='js_article' class='rich_media'><div><a href='https://mp.weixin.qq.com/s?__biz=MzAxMjU4NzczOA==&mid=2247484528&idx=1&sn=871c591dcf618807531cce987ca4f5c0&chksm=9baec3c5acd94ad35218bfc1525f5e00808411ed13b85cb62864203223f28142dd70b4530907&mpshare=1&scene=1&srcid=1022YR9nUuINGjQ8uaQQSl43#rd' target='_blank'>https://mp.weixin.qq.com/s?__biz=MzAxMjU4NzczOA==&mid=2247484528&idx=1&sn=871c591dcf618807531cce987ca4f5c0&chksm=9baec3c5acd94ad35218bfc1525f5e00808411ed13b85cb62864203223f28142dd70b4530907&mpshare=1&scene=1&srcid=1022YR9nUuINGjQ8uaQQSl43#rd</a><a href='https://www.52pojie.cn' class='fwjm' target='_blank'>提供的爬取软件来源于：52pojie.cn@夜泉  免费使用</a></div><div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">
                    
                    
                    高性能Netty实战-http协议解析

                                                                                </h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                Java耕耘者
                                            </span>
                                        
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" id="js_name">
                        Java这点事                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">Java这点事</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Java20177</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">Java,Java简历,java面试题,Java笔试题,java环境变量设置,java教程,java视频,java论坛,Java社区,IT教程,Java这点事</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text"></em>





                </div>
                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">一丶 Netty基础入门</strong></span></p><p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">Netty是一个高性能、异步事件驱动的NIO框架，它提供了对TCP、UDP和文件传输的支持，作为一个异步NIO框架，Netty的所有IO操作都是异步非阻塞的，通过Future-Listener机制，用户可以方便的主动获取或者通过通知机制获得IO操作结果。</span></p><p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">作为当前最流行的NIO框架，Netty在互联网领域、大数据分布式计算领域、游戏行业、通信行业等获得了广泛的应用，一些业界著名的开源组件也基于Netty的NIO框架构建。</span></p><p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">二丶 Netty高性能之道</strong></span></p><p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">RPC调用的性能模型分析</strong></span></p><p style="margin: 10px auto;max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: &quot;black Verdana&quot;, Arial, Helvetica, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">RPC 的全称是 Remote Procedure Call 是一种进程间通信方式。 它允许程序调用另一个地址空间（通常是共享网络的另一台机器上）的过程或函数，而不用程序员显式编码这个远程调用的细节。即程序员无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">HTTP理解客户端和服务器端的交互步骤</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">客户端和服务器端的交互步骤如下：</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">1、Client向Server发送http请求。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">2、Server端对http请求进行解析。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">3、Server端向client发送http响应。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">4、Client对http响应进行解析。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">在这些步骤中会涉及到http请求的编码、解码，http响应的编码、解码。幸运的是，Netty已经为我们提供了这些工具，整个实例的逻辑图如下所示：&nbsp;</span><img class="" data-ratio="0.44621026894865523" src="images/oQ404ibWVRaX0ibVtF5iaABNY2od9VSoQmibN1lPlZsic5VstHzcMQCia1VT5PTZK8HhQ9j13gOTstXbdQ6DicRYrh73Q.jpeg" data-type="jpeg" data-w="818" style="box-sizing: border-box !important;word-wrap: break-word !important;width: 677px !important;visibility: visible !important;"></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">其中红色框中的4个类是Netty提供的，它们其实也是一种Handler，其中Encoder继承自ChannelOutboundHandler，Decoder继承自ChannelInboundHandler，它们的作用是：<br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">1、HttpRequestEncoder：对httpRequest进行编码。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">2、HttpRequestDecoder：把流数据解析为httpRequest。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">3、HttpResponsetEncoder：对httpResponset进行编码。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">4、HttpResponseEncoder：把流数据解析为httpResponse。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">该实例涉及到的类有5个：HttpServer HttpServerInboundHandler HttpClient HttpClientInboundHandler ByteBufToBytes</span></p><h1 style="margin-top: 30px;font-size: 24px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;border-bottom-color: rgb(46, 61, 84);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">netty实现</span></h1><h2 style="margin-top: 30px;font-size: 18px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;border-bottom-color: rgb(46, 61, 84);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">http协议实现的抽象</span></h2><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; 很多http server(比如tomcat,resin)的实现都是基于servlet，但是netty对http实现并没有基于servlet。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;下面将对请求request的抽象进行描述。 response对象的抽象比较类似，将不做描述</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="0.5039473684210526" data-s="300,640" src="images/oQ404ibWVRaX0ibVtF5iaABNY2od9VSoQmibD9R0vUKPCs3bqdTRsicLSbmdRqUQXOPMiboI61VVqMP1dTNKV566VFCQ.png" data-type="png" data-w="760" style="background-color: rgb(238, 237, 235);border-width: 1px;border-style: solid;border-color: rgb(238, 237, 235);background-size: 22px;background-position: center center;background-repeat: no-repeat;height: 341.172px !important;box-sizing: border-box !important;word-wrap: break-word !important;width: 677px !important;"></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);line-height: 20px;font-family: Arial, sans-serif;font-size: 14px;word-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp;&nbsp;HttpMethod：主要是对method的封装，包含method序列化的操作</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; HttpVersion: 对version的封装，netty包含1.0和1.1的版本</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;font-size: 16px;color: rgb(0, 0, 0);word-wrap: break-word !important;">&nbsp; &nbsp;&nbsp;<span style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;">QueryStringDecoder</span>: 主要是对url进行封装，解析path和url上面的参数。(Tips：在tomcat中如果提交的post请求是application/x-www-form-urlencoded，则getParameter获取的是包含url后面和body里面所有的参数，而在netty中，获取的仅仅是url上面的参数)</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;&nbsp;HttpHeaders：包含对header的内容进行封装及操作</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;&nbsp;HttpContent：是对body进行封装，本质上就是一个ByteBuf。如果ByteBuf的长度是固定的，则请求的body过大，可能包含多个HttpContent，其中最后一个为LastHttpContent(空的HttpContent),用来说明body的结束。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;HttpRequest：主要包含对Request Line和Header的组合</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;FullHttpRequest： 主要包含对HttpRequest和httpContent的组合</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;"><br data-filtered="filtered" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"  /></span></p><h2 style="margin-top: 10px;font-size: 18px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;line-height: 1.5;font-size: 16px;word-wrap: break-word !important;">request的流程处理</span></h2><h3 style="margin-top: 10px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;">实现：</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;只需要在netty的pipeLine中配置HttpRequestDecoder和HttpObjectAggregator。</span></p><h3 style="margin-top: 30px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;">原理：</span></h3><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="0.4238845144356955" data-s="300,640" src="images/oQ404ibWVRaX0ibVtF5iaABNY2od9VSoQmibESIk97lqLasibvnhZ8VCPiaUtsSAY3NlmO9pzzkfP7V1c0Jgibc7M31gw.png" data-type="png" data-w="762" style="box-sizing: border-box !important;word-wrap: break-word !important;width: 677px !important;visibility: visible !important;"></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;font-size: 16px;color: rgb(0, 0, 0);word-wrap: break-word !important;">&nbsp; &nbsp;&nbsp;<br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"  /></span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;1：如果把解析这块理解是一个黑盒的话，则输入是ByteBuf，输出是FullHttpRequest。通过该对象便可获取到所有与http协议有关的信息。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; 2：HttpRequestDecoder先通过RequestLine和Header解析成HttpRequest对象，传入到HttpObjectAggregator。然后再通过body解析出httpContent对象，传入到HttpObjectAggregator。当HttpObjectAggregator发现是LastHttpContent，则代表http协议解析完成，封装FullHttpRequest。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;3：对于body内容的读取涉及到Content-Length和trunked两种方式。两种方式只是在解析协议时处理的不一致，最终输出是一致的。</span></p><h3 style="margin-top: 10px;font-size: 14px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;line-height: 1.5625;font-size: 16px;word-wrap: break-word !important;">&nbsp;面临的问题：</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;1：假设申请的ByteBuf为1k，如果读取request Line，把ByteBuf都读取完了还没有发现边界(CRLF)，如何处理？</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;一般的做法为：先申请1k大小的ByteBuf，如果发现当前ByteBuf大小不够。 一般会再申请之前大小2倍的ByteBuf(也就是2k)，然后把之前1k的数据拷贝到新申请的2k的空间里面，然后再到JDK的io中读取数据。如果再不够用，则再申请2倍的byteBuf。 &nbsp;如果数据量比较大，会面临着申请新空间-&gt;拷贝数据-&gt;申请更大的空间-&gt;再拷贝数据.... &nbsp; 。该种方案性能极其低下，如何提升性能？</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; 2：如果申请的buffer在堆上面，由于该buffer存活周期很短，会造成频繁的GC，影响系统性能。</span></p><h3 style="margin-top: 30px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;">性能优化：</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; 1：使用堆外内存，也就是DirectBuffer。来减少GC的次数。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; 2：使用buffer pool，避免频繁的申请及释放内存。一般pool有两层，ThreadLocal的pool和全局的pool。 申请buffer空间时，先看ThreadLocal是否有未使用的buffer，如果没有，再从全局的pool中获取buffer。一般的内存管理策略是pool里面的buffer大小全部一致(比如1k)，但是 如果需要申请2k的空间，必须要新建2k空间的buffer。如果频繁申请大于1K空间内存，则性能比较低下。 netty为了解决该问题，使用了较为复杂的内存管理策略</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; 3：零拷贝：前面提到拷贝数据的性能问题，采用零拷贝机制可有效解决该问题</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;&nbsp;CompositeByteBuf(组合)： 比如读取request Line，申请1k的空间ByteBuf，如果没有发现边界(CRLF)。再申请1k的空间ByteBuf到JDK的io中读取数据。将老的ByteBuf和新申请的ByteBuf组合成CompositeByteBuf，更改CompositeByteBuf的读写指针来避免数据的拷贝。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">response的流程处理</span></p><h3 style="margin-top: 10px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">实现</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp;只需要在netty的pipeLine中配置HttpResponseEncoder&nbsp;</span></p><h3 style="margin-top: 10px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">原理</span></h3><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="0.40497737556561086" data-s="300,640" src="images/oQ404ibWVRaX0ibVtF5iaABNY2od9VSoQmibNzicu0qjdVJb6zwRL12lcwdFgBic6CoF0cPETdLwwjn8bVnBiboTAef0g.png" data-type="png" data-w="442" style="background-color: rgb(238, 237, 235);border-width: 1px;border-style: solid;border-color: rgb(238, 237, 235);background-size: 22px;background-position: center center;background-repeat: no-repeat;height: 179px !important;box-sizing: border-box !important;word-wrap: break-word !important;width: 442px !important;"></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br data-filtered="filtered" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"  /></span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;1：输入是FullHttpResponse对象，输出是ByteBuf。socket再将ByteBuf数据发送到访问端。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;2：对FullHttpResponse按照http协议进行序列化。判断header里面是ContentLength还是Trunked，然后body按照相应的协议进行序列化。&nbsp;</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;3：具体原理和request请求方式比较类似，这次不再详细描述。 &nbsp; &nbsp;</span></p><h2 style="margin-top: 30px;font-size: 18px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp;压缩实现</span></h2><h3 style="margin-top: 10px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">&nbsp;实现</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; &nbsp;在HttpResponseEncoder之前加上&nbsp;HttpContentCompressor 。response对象先进过HttpContentCompressor 压缩后，再经过HttpResponseEncoder进行序列化。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;white-space: normal;letter-spacing: 1.5px;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="0.4840085287846482" data-s="300,640" src="images/oQ404ibWVRaX0ibVtF5iaABNY2od9VSoQmiby51kwaBWaOpXaImtPm4xBibB42ztWkgoEy0S2tiaTibZeKWVCs51nnLMA.png" data-type="png" data-w="469" style="box-sizing: border-box !important;word-wrap: break-word !important;width: 469px !important;visibility: visible !important;"></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br data-filtered="filtered" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"  /></span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; &nbsp;1：压缩主要是针对body进行压缩。http1.1不支持对header的压缩。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp; &nbsp; 2：压缩后body的输出是trunked，而不是Content-length的形式。</span></p><h3 style="margin-top: 10px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;">Gzip格式</span></h3><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp; &nbsp;&nbsp;gzip压缩后主要包含三部分：</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp;gzip头：主要存储的是gzip的压缩方式</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp;deflate编码：内容采用的是deflate压缩算法</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">&nbsp; &nbsp;gzip尾：主要是采用CRC32算法对编码内容进行校验。</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);letter-spacing: 0.544px;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);line-height: 20px;font-family: Arial, sans-serif;font-size: 14px;word-wrap: break-word !important;"><br data-filtered="filtered" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"  /></p><h1 style="margin-top: 30px;font-size: 24px;max-width: 100%;box-sizing: border-box;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background: none rgb(255, 255, 255);font-family: Arial, sans-serif;border-bottom-color: rgb(46, 61, 84);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">安全配置</span></h1><p style="padding-top: 7px;padding-bottom: 7px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;vertical-align: top;border-top-width: 1px;border-top-color: rgb(221, 221, 221);white-space: pre-wrap;background-color: rgb(240, 240, 240);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">参数</span></p><p style="padding-top: 7px;padding-bottom: 7px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;vertical-align: top;border-top-width: 1px;border-top-color: rgb(221, 221, 221);white-space: pre-wrap;background-color: rgb(240, 240, 240);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">推荐</span></p><p style="padding-top: 7px;padding-bottom: 7px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;vertical-align: top;border-top-width: 1px;border-top-color: rgb(221, 221, 221);white-space: pre-wrap;background-color: rgb(240, 240, 240);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">返回错误码</span></p><p style="padding-top: 7px;padding-bottom: 7px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;text-align: justify;vertical-align: top;border-top-width: 1px;border-top-color: rgb(221, 221, 221);white-space: pre-wrap;background-color: rgb(240, 240, 240);letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">描述</span></p><table width="378"><tbody style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><tr style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><td style="word-break: break-all;max-width: 100%;word-wrap: break-word !important;box-sizing: border-box !important;"><br  /></td><td style="word-break: break-all;max-width: 100%;word-wrap: break-word !important;box-sizing: border-box !important;"><br  /></td><td style="word-break: break-all;max-width: 100%;word-wrap: break-word !important;box-sizing: border-box !important;"><br  /></td><td style="word-break: break-all;max-width: 100%;word-wrap: break-word !important;box-sizing: border-box !important;"><br  /></td></tr><tr style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">requst Line size</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">2k</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">414</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">主要是限制url的长度</span></p></td></tr><tr style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">header size</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">4k</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">414</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">避免header过长</span></p></td></tr><tr style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">body size</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">60M</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">413</span></p></td><td style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">此处一般和业务关联，一般设置相对较大</span></p></td></tr><tr style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><td colspan="1" style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">keepalive timeout</span></p></td><td colspan="1" style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">75</span></p></td><td colspan="1" style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><br  /></td><td colspan="1" style="padding-top: 7px;padding-bottom: 7px;word-break: break-all;max-width: 100%;box-sizing: border-box;line-height: 20px;text-align: center;color: rgb(85, 85, 85);vertical-align: top;white-space: pre-wrap;word-wrap: break-word !important;"><p style="max-width: 100%;min-height: 1em;letter-spacing: 1.5px;text-align: justify;line-height: 1.5em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;box-sizing: border-box !important;word-wrap: break-word !important;">如果连接在设定时间内没有使用，则关闭掉连接，避免维护的连接过多</span></p></td></tr></tbody></table><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">GET和POST的区别，笔者之前理解的其中一项是：get的url长度有限制，post的body长度没有限制。 &nbsp;&nbsp;</span></p><p style="margin-top: 10px;max-width: 100%;box-sizing: border-box;min-height: 1em;color: rgb(51, 51, 51);text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);font-family: Arial, sans-serif;font-size: 14px;letter-spacing: 1.5px;line-height: 1.5em;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);font-size: 16px;word-wrap: break-word !important;">其实这种理解是有偏差的：不管是url长度限制或者body长度限制都是有后端http容器配置的。 body的长度限制一般比get的url长度限制稍大。</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;text-align: justify;white-space: normal;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 16px;color: rgb(34, 34, 34);font-weight: bold;box-sizing: border-box !important;word-wrap: break-word !important;">关注：公众号</span></p><p style="max-width: 100%;min-height: 1em;color: rgb(51, 51, 51);font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 17px;letter-spacing: 0.544px;white-space: normal;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="1" data-s="300,640" src="images/oQ404ibWVRaUWtib6vz46Po91qTLhficYm3kgEsRV4Jsicu9KPnVX4icGXdicDGcgSybdvib0bP3EvXz6pmueAWu0eKDA.jpeg" data-type="jpeg" data-w="430" style="box-sizing: border-box !important;word-wrap: break-word !important;width: 430px !important;visibility: visible !important;"></p><p><span style="max-width: 100%;font-size: 16px;color: rgb(34, 34, 34);font-weight: bold;box-sizing: border-box !important;word-wrap: break-word !important;"><br  /></span></p><p><br  /></p>
                </div>
                

                
                <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">Java耕耘者</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p>
                        <a class="reward_button" id='js_preview_reward_author_link' href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                                
                
                            </div></div></body>